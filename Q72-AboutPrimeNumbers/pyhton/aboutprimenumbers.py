from datetime import datetime, timedelta
from math import isqrt


def is_prime(n: int) -> bool:
    if not isinstance(n, int):
        raise ValueError("Argument 'n' must be an integer.")
    n = abs(n)
    if n < 2:
        return False

    if n in (2, 3):
        return True

    # check multiples of 2 and 3
    if n % 2 == 0 or n % 3 == 0:
        return False

    isqrt_n = isqrt(n)  # Highest value to test

    # Sieving by: p = 6 * i Â± 1
    i = 5

    while i <= isqrt_n:
        if (n % i == 0) or (n % (i + 2) == 0):
            return False
        i += 6

    return True


def prime_floor(n: int) -> int:

    if not isinstance(n, int):
        raise ValueError("Argument 'n' must be an integer.")

    if n == 1 or n == 0 or n == -1:
        return -2

    while not is_prime(n):
        n -= 1

    return n


def prime_ceiling(n: int) -> int:

    if not isinstance(n, int):
        raise ValueError("Argument 'n' must be an integer.")

    if n == 1 or n == 0 or n == -1:
        return 2

    while not is_prime(n):
        n += 1

    return n


if __name__ == "__main__":
    print("Start 'is_prime' tests.")
    is_prime_tests = [
        (-17, True),
        (-15, False),
        (-13, True),
        (13, True),
        (15, False),
        (17, True),
        (-37, True),
        (-35, False),
        (-31, True),
        (31, True),
        (35, False),
        (37, True),
        (-149, True),
        (-143, False),
        (-139, True),
        (139, True),
        (143, False),
        (149, True),
        (-331, True),
        (-323, False),
        (-317, True),
        (317, True),
        (323, False),
        (331, True),
        (-907, True),
        (-899, False),
        (-887, True),
        (887, True),
        (899, False),
        (907, True),
        (-1777, True),
        (-1763, False),
        (-1759, True),
        (1759, True),
        (1763, False),
        (1777, True),
        (-3607, True),
        (-3599, False),
        (-3593, True),
        (3593, True),
        (3599, False),
        (3607, True),
        (-5189, True),
        (-5183, False),
        (-5179, True),
        (5179, True),
        (5183, False),
        (5189, True),
        (-10427, True),
        (-10403, False),
        (-10399, True),
        (10399, True),
        (10403, False),
        (10427, True),
        (-11677, True),
        (-11663, False),
        (-11657, True),
        (11657, True),
        (11663, False),
        (11677, True),
        (-19051, True),
        (-19043, False),
        (-19037, True),
        (19037, True),
        (19043, False),
        (19051, True),
        (-22501, True),
        (-22499, False),
        (-22483, True),
        (22483, True),
        (22499, False),
        (22501, True),
        (-32401, True),
        (-32399, False),
        (-32381, True),
        (32381, True),
        (32399, False),
        (32401, True),
        (-121123, True),
        (-121103, False),
        (-121081, True),
        (121081, True),
        (121103, False),
        (121123, True),
        (-176401, True),
        (-176399, False),
        (-176389, True),
        (176389, True),
        (176399, False),
        (176401, True),
        (-186629, True),
        (-186623, False),
        (-186619, True),
        (186619, True),
        (186623, False),
        (186629, True),
        (-213449, True),
        (-213443, False),
        (-213407, True),
        (213407, True),
        (213443, False),
        (213449, True),
        (-272507, True),
        (-272483, False),
        (-272477, True),
        (272477, True),
        (272483, False),
        (272507, True),
        (-1040407, True),
        (-1040399, False),
        (-1040387, True),
        (1040387, True),
        (1040399, False),
        (1040407, True),
        (-1065037, True),
        (-1065023, False),
        (-1065019, True),
        (1065019, True),
        (1065023, False),
        (1065037, True),
        (-1102523, True),
        (-1102499, False),
        (-1102483, True),
        (1102483, True),
        (1102499, False),
        (1102523, True),
        (-1127849, True),
        (-1127843, False),
        (-1127837, True),
        (1127837, True),
        (1127843, False),
        (1127849, True),
        (-1192469, True),
        (-1192463, False),
        (-1192453, True),
        (1192453, True),
        (1192463, False),
        (1192469, True),
        (-10036231, True),
        (-10036223, False),
        (-10036183, True),
        (10036183, True),
        (10036223, False),
        (10036231, True),
        (-10575529, True),
        (-10575503, False),
        (-10575473, True),
        (10575473, True),
        (10575503, False),
        (10575529, True),
        (-10614587, True),
        (-10614563, False),
        (-10614547, True),
        (10614547, True),
        (10614563, False),
        (10614587, True),
        (-10890023, True),
        (-10889999, False),
        (-10889987, True),
        (10889987, True),
        (10889999, False),
        (10890023, True),
        (-11088907, True),
        (-11088899, False),
        (-11088881, True),
        (11088881, True),
        (11088899, False),
        (11088907, True),
        (-100160069, True),
        (-100160063, False),
        (-100160051, True),
        (100160051, True),
        (100160063, False),
        (100160069, True),
        (-100761449, True),
        (-100761443, False),
        (-100761403, True),
        (100761403, True),
        (100761443, False),
        (100761449, True),
        (-101364643, True),
        (-101364623, False),
        (-101364619, True),
        (101364619, True),
        (101364623, False),
        (101364643, True),
        (-101848471, True),
        (-101848463, False),
        (-101848441, True),
        (101848441, True),
        (101848463, False),
        (101848471, True),
        (-102819611, True),
        (-102819599, False),
        (-102819589, True),
        (102819589, True),
        (102819599, False),
        (102819611, True),
        (-1006285303, True),
        (-1006285283, False),
        (-1006285279, True),
        (1006285279, True),
        (1006285283, False),
        (1006285303, True),
        (-1006666013, True),
        (-1006665983, False),
        (-1006665973, True),
        (1006665973, True),
        (1006665983, False),
        (1006666013, True),
        (-1009332913, True),
        (-1009332899, False),
        (-1009332893, True),
        (1009332893, True),
        (1009332899, False),
        (1009332913, True),
        (-1014295181, True),
        (-1014295103, False),
        (-1014295099, True),
        (1014295099, True),
        (1014295103, False),
        (1014295181, True),
        (-1025792791, True),
        (-1025792783, False),
        (-1025792777, True),
        (1025792777, True),
        (1025792783, False),
        (1025792791, True),
        (-10030423153, True),
        (-10030423103, False),
        (-10030423061, True),
        (10030423061, True),
        (10030423103, False),
        (10030423153, True),
        (-10072531069, True),
        (-10072531043, False),
        (-10072531031, True),
        (10072531031, True),
        (10072531043, False),
        (10072531069, True),
        (-10078553669, True),
        (-10078553663, False),
        (-10078553603, True),
        (10078553603, True),
        (10078553663, False),
        (10078553669, True),
        (-10103868367, True),
        (-10103868323, False),
        (-10103868311, True),
        (10103868311, True),
        (10103868323, False),
        (10103868367, True),
        (-10109900371, True),
        (-10109900303, False),
        (-10109900287, True),
        (10109900287, True),
        (10109900303, False),
        (10109900371, True),
        (-100009002581, True),
        (-100009002563, False),
        (-100009002559, True),
        (100009002559, True),
        (100009002563, False),
        (100009002581, True),
        (-100153260931, True),
        (-100153260899, False),
        (-100153260871, True),
        (100153260871, True),
        (100153260899, False),
        (100153260931, True),
        (-100172250023, True),
        (-100172249999, False),
        (-100172249971, True),
        (100172249971, True),
        (100172249999, False),
        (100172250023, True),
        (-100274822267, True),
        (-100274822243, False),
        (-100274822227, True),
        (100274822227, True),
        (100274822243, False),
        (100274822267, True),
        (-100297623211, True),
        (-100297623203, False),
        (-100297623197, True),
        (100297623197, True),
        (100297623203, False),
        (100297623211, True),
        (-1000076001499, True),
        (-1000076001443, False),
        (-1000076001317, True),
        (1000076001317, True),
        (1000076001443, False),
        (1000076001499, True),
        (-1000424044987, True),
        (-1000424044943, False),
        (-1000424044933, True),
        (1000424044933, True),
        (1000424044943, False),
        (1000424044987, True),
        (-1000580084159, True),
        (-1000580084099, False),
        (-1000580084093, True),
        (1000580084093, True),
        (1000580084099, False),
        (1000580084159, True),
        (-1000856183189, True),
        (-1000856183183, False),
        (-1000856183147, True),
        (1000856183147, True),
        (1000856183183, False),
        (1000856183189, True),
        (-1001156334097, True),
        (-1001156334083, False),
        (-1001156334047, True),
        (1001156334047, True),
        (1001156334083, False),
        (1001156334097, True),
        (-10000255133147, True),
        (-10000255133123, False),
        (-10000255133101, True),
        (10000255133101, True),
        (10000255133123, False),
        (10000255133147, True),
        (-10002494179589, True),
        (-10002494179583, False),
        (-10002494179543, True),
        (10002494179543, True),
        (10002494179583, False),
        (10002494179589, True),
        (-10005568532989, True),
        (-10005568532963, False),
        (-10005568532951, True),
        (10005568532951, True),
        (10005568532963, False),
        (10005568532989, True),
        (-10006137909539, True),
        (-10006137909503, False),
        (-10006137909499, True),
        (10006137909499, True),
        (10006137909503, False),
        (10006137909539, True),
        (-10007428556329, True),
        (-10007428556303, False),
        (-10007428556291, True),
        (10007428556291, True),
        (10007428556303, False),
        (10007428556329, True),
        (-100002800019613, True),
        (-100002800019599, False),
        (-100002800019589, True),
        (100002800019589, True),
        (100002800019599, False),
        (100002800019613, True),
        (-100009040204309, True),
        (-100009040204303, False),
        (-100009040204219, True),
        (100009040204219, True),
        (100009040204303, False),
        (100009040204309, True),
        (-100014440521297, True),
        (-100014440521283, False),
        (-100014440521231, True),
        (100014440521231, True),
        (100014440521283, False),
        (100014440521297, True),
        (-100017440760427, True),
        (-100017440760383, False),
        (-100017440760379, True),
        (100017440760379, True),
        (100017440760383, False),
        (100017440760427, True),
        (-100024161459269, True),
        (-100024161459263, False),
        (-100024161459199, True),
        (100024161459199, True),
        (100024161459263, False),
        (100024161459269, True),
    ]

    for n, expected in is_prime_tests:
        actual = is_prime(n)
        if actual != expected:
            print(f"is_prime({n}) result {actual} != {expected} expected.")

    print("'is_prime' tests complete.")

    print("Start 'prime_floor' tests.")
    floor_ceiling_prime_tests = [
        (-17, -15, -13),
        (13, 15, 17),
        (-37, -35, -31),
        (31, 35, 37),
        (-149, -143, -139),
        (139, 143, 149),
        (-331, -323, -317),
        (317, 323, 331),
        (-907, -899, -887),
        (887, 899, 907),
        (-1777, -1763, -1759),
        (1759, 1763, 1777),
        (-3607, -3599, -3593),
        (3593, 3599, 3607),
        (-5189, -5183, -5179),
        (5179, 5183, 5189),
        (-10427, -10403, -10399),
        (10399, 10403, 10427),
        (-11677, -11663, -11657),
        (11657, 11663, 11677),
        (-19051, -19043, -19037),
        (19037, 19043, 19051),
        (-22501, -22499, -22483),
        (22483, 22499, 22501),
        (-32401, -32399, -32381),
        (32381, 32399, 32401),
        (-121123, -121103, -121081),
        (121081, 121103, 121123),
        (-176401, -176399, -176389),
        (176389, 176399, 176401),
        (-186629, -186623, -186619),
        (186619, 186623, 186629),
        (-213449, -213443, -213407),
        (213407, 213443, 213449),
        (-272507, -272483, -272477),
        (272477, 272483, 272507),
        (-1040407, -1040399, -1040387),
        (1040387, 1040399, 1040407),
        (-1065037, -1065023, -1065019),
        (1065019, 1065023, 1065037),
        (-1102523, -1102499, -1102483),
        (1102483, 1102499, 1102523),
        (-1127849, -1127843, -1127837),
        (1127837, 1127843, 1127849),
        (-1192469, -1192463, -1192453),
        (1192453, 1192463, 1192469),
        (-10036231, -10036223, -10036183),
        (10036183, 10036223, 10036231),
        (-10575529, -10575503, -10575473),
        (10575473, 10575503, 10575529),
        (-10614587, -10614563, -10614547),
        (10614547, 10614563, 10614587),
        (-10890023, -10889999, -10889987),
        (10889987, 10889999, 10890023),
        (-11088907, -11088899, -11088881),
        (11088881, 11088899, 11088907),
        (-100160069, -100160063, -100160051),
        (100160051, 100160063, 100160069),
        (-100761449, -100761443, -100761403),
        (100761403, 100761443, 100761449),
        (-101364643, -101364623, -101364619),
        (101364619, 101364623, 101364643),
        (-101848471, -101848463, -101848441),
        (101848441, 101848463, 101848471),
        (-102819611, -102819599, -102819589),
        (102819589, 102819599, 102819611),
        (-1006285303, -1006285283, -1006285279),
        (1006285279, 1006285283, 1006285303),
        (-1006666013, -1006665983, -1006665973),
        (1006665973, 1006665983, 1006666013),
        (-1009332913, -1009332899, -1009332893),
        (1009332893, 1009332899, 1009332913),
        (-1014295181, -1014295103, -1014295099),
        (1014295099, 1014295103, 1014295181),
        (-1025792791, -1025792783, -1025792777),
        (1025792777, 1025792783, 1025792791),
        (-10030423153, -10030423103, -10030423061),
        (10030423061, 10030423103, 10030423153),
        (-10072531069, -10072531043, -10072531031),
        (10072531031, 10072531043, 10072531069),
        (-10078553669, -10078553663, -10078553603),
        (10078553603, 10078553663, 10078553669),
        (-10103868367, -10103868323, -10103868311),
        (10103868311, 10103868323, 10103868367),
        (-10109900371, -10109900303, -10109900287),
        (10109900287, 10109900303, 10109900371),
        (-100009002581, -100009002563, -100009002559),
        (100009002559, 100009002563, 100009002581),
        (-100153260931, -100153260899, -100153260871),
        (100153260871, 100153260899, 100153260931),
        (-100172250023, -100172249999, -100172249971),
        (100172249971, 100172249999, 100172250023),
        (-100274822267, -100274822243, -100274822227),
        (100274822227, 100274822243, 100274822267),
        (-100297623211, -100297623203, -100297623197),
        (100297623197, 100297623203, 100297623211),
        (-1000076001499, -1000076001443, -1000076001317),
        (1000076001317, 1000076001443, 1000076001499),
        (-1000424044987, -1000424044943, -1000424044933),
        (1000424044933, 1000424044943, 1000424044987),
        (-1000580084159, -1000580084099, -1000580084093),
        (1000580084093, 1000580084099, 1000580084159),
        (-1000856183189, -1000856183183, -1000856183147),
        (1000856183147, 1000856183183, 1000856183189),
        (-1001156334097, -1001156334083, -1001156334047),
        (1001156334047, 1001156334083, 1001156334097),
        (-10000255133147, -10000255133123, -10000255133101),
        (10000255133101, 10000255133123, 10000255133147),
        (-10002494179589, -10002494179583, -10002494179543),
        (10002494179543, 10002494179583, 10002494179589),
        (-10005568532989, -10005568532963, -10005568532951),
        (10005568532951, 10005568532963, 10005568532989),
        (-10006137909539, -10006137909503, -10006137909499),
        (10006137909499, 10006137909503, 10006137909539),
        (-10007428556329, -10007428556303, -10007428556291),
        (10007428556291, 10007428556303, 10007428556329),
        (-100002800019613, -100002800019599, -100002800019589),
        (100002800019589, 100002800019599, 100002800019613),
        (-100009040204309, -100009040204303, -100009040204219),
        (100009040204219, 100009040204303, 100009040204309),
        (-100014440521297, -100014440521283, -100014440521231),
        (100014440521231, 100014440521283, 100014440521297),
        (-100017440760427, -100017440760383, -100017440760379),
        (100017440760379, 100017440760383, 100017440760427),
        (-100024161459269, -100024161459263, -100024161459199),
        (100024161459199, 100024161459263, 100024161459269),
    ]
    for expected_floor, n, expected_ceiling in floor_ceiling_prime_tests:
        actual_floor = prime_floor(n)
        if actual_floor != expected_floor:
            print(
                f"prime_floor({n}) result {actual_floor} != {expected_floor} expected."
            )

        actual_ceiling = prime_ceiling(n)
        if actual_ceiling != expected_ceiling:
            print(
                f"prime_floor({n}) result {actual_ceiling} != {expected_ceiling} expected."
            )

    print("'prime_floor' tests complete.")
